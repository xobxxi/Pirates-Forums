<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="album" title="User Albums" version_string="0.5.0 Beta" version_id="5" url="http://piratesforums.com" install_callback_class="Album_Install" install_callback_method="install" uninstall_callback_class="Album_Install" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="template_create" execute_order="10" callback_class="Album_Listener" callback_method="templateCreate" active="1" description="Preloads templates"/>
    <listener event_id="template_hook" execute_order="10" callback_class="Album_Listener" callback_method="templateHook" active="1" description="Uses template hooks to spit into templates"/>
  </code_event_listeners>
  <cron>
    <entry entry_id="album_remove_empty" cron_class="Album_CronEntry_Album" cron_method="removeEmptyAlbums" active="1"><![CDATA[{"day_type":"dom","dom":["-1"],"hours":["0"],"minutes":["0"]}]]></entry>
  </cron>
  <email_templates/>
  <optiongroups>
    <group group_id="album" display_order="1000" debug_only="0"/>
    <option option_id="albumMaxPhotos" edit_format="spinbox" data_type="integer" can_backup="1">
      <default_value>100</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="album" display_order="0"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups>
      <permission_group permission_group_id="album"/>
    </permission_groups>
    <permissions>
      <permission permission_group_id="album" permission_id="manage" permission_type="flag" depend_permission_id="upload" default_value="unset" interface_group_id="album" display_order="30"/>
      <permission permission_group_id="album" permission_id="upload" permission_type="flag" default_value="unset" interface_group_id="album" display_order="20"/>
      <permission permission_group_id="album" permission_id="view" permission_type="flag" default_value="allow" interface_group_id="album" display_order="0"/>
      <permission permission_group_id="album" permission_id="view_photos" permission_type="flag" default_value="unset" interface_group_id="album" display_order="10"/>
    </permissions>
    <interface_groups>
      <interface_group interface_group_id="album" display_order="1000"/>
    </interface_groups>
  </permissions>
  <phrases>
    <phrase title="album_added" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Added]]></phrase>
    <phrase title="album_add_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Add Album]]></phrase>
    <phrase title="album_add_description" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Add a description]]></phrase>
    <phrase title="album_add_photos" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Add Photos]]></phrase>
    <phrase title="album_albums" version_id="0" version_string="0.0.1 Pre-alpha"><![CDATA[Albums]]></phrase>
    <phrase title="album_albums_must_contain_at_least_one_photo" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Albums must contain at least one photo.]]></phrase>
    <phrase title="album_album_name" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Album Name]]></phrase>
    <phrase title="album_all_album_contents_will_be_removed" version_id="2" version_string="0.1.0 Alpha"><![CDATA[All photos, comments, and likes in this album will be removed.]]></phrase>
    <phrase title="album_all_photo_contents_will_be_removed" version_id="2" version_string="0.1.0 Alpha"><![CDATA[All comments and likes for this photo will be removed.]]></phrase>
    <phrase title="album_close" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Close]]></phrase>
    <phrase title="album_delete_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Delete Album]]></phrase>
    <phrase title="album_delete_album_x" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Delete Album: {album}]]></phrase>
    <phrase title="album_delete_photo" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Delete Photo]]></phrase>
    <phrase title="album_delete_photo_in_album_x" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Delete Photo In Album: {album}]]></phrase>
    <phrase title="album_edit_photo" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Edit Photo]]></phrase>
    <phrase title="album_from_the_album" version_id="2" version_string="0.1.0 Alpha"><![CDATA[From the album: <a{link_params}>{album}</a>]]></phrase>
    <phrase title="album_hash_id_missing" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Hash ID missing.]]></phrase>
    <phrase title="album_make_cover_photo" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Make Cover Photo]]></phrase>
    <phrase title="album_manage_album" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[Manage Album]]></phrase>
    <phrase title="album_new_photos" version_id="2" version_string="0.1.0 Alpha"><![CDATA[New Photos]]></phrase>
    <phrase title="album_next" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Next]]></phrase>
    <phrase title="album_no_album_id_specified" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[No album ID was specified.]]></phrase>
    <phrase title="album_no_photos_in_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[There are no photos in this album.]]></phrase>
    <phrase title="album_no_photo_id_specified" version_id="2" version_string="0.1.0 Alpha"><![CDATA[No Photo ID was specified.]]></phrase>
    <phrase title="album_one_photo" version_id="1" version_string="0.0.1 Alpha"><![CDATA[1 Photo]]></phrase>
    <phrase title="album_own_albums" version_id="1" version_string="0.0.1 Alpha"><![CDATA[own albums]]></phrase>
    <phrase title="album_photos" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[Photos]]></phrase>
    <phrase title="album_photo_description" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Photo Description]]></phrase>
    <phrase title="album_photo_x_of_y" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Photo {current} of {total}]]></phrase>
    <phrase title="album_please_enter_album_name" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Please enter a name for the album.]]></phrase>
    <phrase title="album_previous" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Previous]]></phrase>
    <phrase title="album_requested_album_not_found" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[The requested album could not be found.]]></phrase>
    <phrase title="album_requested_photo_not_found" version_id="2" version_string="0.1.0 Alpha"><![CDATA[The requested photo could not be found.]]></phrase>
    <phrase title="album_save_album" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[Save Album]]></phrase>
    <phrase title="album_save_photo" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Save Photo]]></phrase>
    <phrase title="album_set_cover_photo_for_x" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Set Cover Photo For: {album}]]></phrase>
    <phrase title="album_the_album_has_been_saved_successfully" version_id="0" version_string="0.0.1 (pre-alpha)"><![CDATA[The album has been saved successfully.]]></phrase>
    <phrase title="album_the_photo_has_been_saved_successfully" version_id="2" version_string="0.1.0 Alpha"><![CDATA[The photo has been saved successfully.]]></phrase>
    <phrase title="album_user_no_albums" version_id="1" version_string="0.0.1 Alpha"><![CDATA[This user has not created any albums.]]></phrase>
    <phrase title="album_viewing_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Viewing album]]></phrase>
    <phrase title="album_viewing_albums" version_id="0" version_string="0.0.1 Pre-alpha"><![CDATA[Viewing albums]]></phrase>
    <phrase title="album_viewing_photo_in_album" version_id="2" version_string="0.1.0 Alpha"><![CDATA[Viewing photo in album]]></phrase>
    <phrase title="album_view_full_size" version_id="2" version_string="0.1.0 Alpha"><![CDATA[View Full Size]]></phrase>
    <phrase title="album_x" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{album}]]></phrase>
    <phrase title="album_xs_albums" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{username}'s albums]]></phrase>
    <phrase title="album_xs_albums_y" version_id="2" version_string="0.1.0 Alpha"><![CDATA[{username}'s Albums - {album}]]></phrase>
    <phrase title="album_x_has_added_a_new_album_y" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{username} has added a new photo  album: <a {link_params}>{name}</a>.]]></phrase>
    <phrase title="album_x_has_added_new_photos_to_album_z" version_id="2" version_string="0.1.0 Alpha"><![CDATA[{username} has added new photos to the album <a {link_params}>{name}</a>.]]></phrase>
    <phrase title="album_x_photos" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{photos} Photos]]></phrase>
    <phrase title="album_x_photos_in_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{photos} photos in album]]></phrase>
    <phrase title="album_x_renamed_an_album_from_y_to_z" version_id="1" version_string="0.0.1 Alpha"><![CDATA[{username} renamed an album from {old} to <a {link_params}>{new}</a>.]]></phrase>
    <phrase title="album_your_albums" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Your Albums]]></phrase>
    <phrase title="cron_entry_album_remove_empty" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Remove Empty Albums]]></phrase>
    <phrase title="option_albumMaxPhotos" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Max Photos]]></phrase>
    <phrase title="option_albumMaxPhotos_explain" version_id="1" version_string="0.0.1 Alpha"><![CDATA[The maximum number of photos allowed in a single album.]]></phrase>
    <phrase title="option_group_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[User Albums]]></phrase>
    <phrase title="option_group_album_description" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Options for user albums.]]></phrase>
    <phrase title="permission_album_manage" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Manage albums]]></phrase>
    <phrase title="permission_album_upload" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Upload photos]]></phrase>
    <phrase title="permission_album_view" version_id="1" version_string="0.0.1 Alpha"><![CDATA[View albums]]></phrase>
    <phrase title="permission_album_view_photos" version_id="1" version_string="0.0.1 Alpha"><![CDATA[View photos]]></phrase>
    <phrase title="permission_group_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[User Albums]]></phrase>
    <phrase title="permission_interface_album" version_id="1" version_string="0.0.1 Alpha"><![CDATA[Albums]]></phrase>
  </phrases>
  <route_prefixes>
    <route_type type="public">
      <prefix original_prefix="albums" class="Album_Route_Prefix_Albums" build_link="data_only"/>
    </route_type>
  </route_prefixes>
  <style_properties/>
  <templates>
    <template title="album.css" version_id="2" version_string="0.1.0 Alpha"><![CDATA[#albums.primaryContent,
#album.primaryContent
{
        overflow: hidden;
}

#albums .imageBox,
#album .imageBox
{
        display: inline-block;
        float: left;
        margin: 10px;
}

#albums .imageBox .thumbnail,
#album .imageBox .thumbnail
{
        background-color: rgb(255, 255, 255);
        width: 150px;
        height: 100px;
        margin: 2px;
        border: 1px solid rgb(238, 238, 238);
        box-shadow: -4px -4px 2px rgb(136, 136, 136);
        background-repeat: no-repeat;
        background-position: center center;
        text-align: center;
        overflow: hidden;
}

#albums .imageBox .thumbnail:hover,
#album .imageBox .thumbnail:hover
{
        border-color: rgb(136, 136, 136);
        box-shadow: -4px -4px 2px rgb(215, 237, 252);
}

#albums .imageBox .stats span
{
        margin-left: 4px;
        display: block;
}

#albums .imageBox .stats span.count
{
        font-size: 11px;
}

#albumPhoto .data .stats
{
        display: inline-block;
}

#albumPhoto .data .navigation
{
        float: right;
}

#albumPhoto .data .navigation a
{
        margin-left: 4px;
}

#albumPhoto .photo
{
        max-height: 720px;
        min-height: 453px;
        margin: 5px 0;
        background-color: rgb(242, 242, 242);
        text-align: center;
}

#albumPhoto .photoInfo
{
        overflow: hidden;
}

#albumPhoto .photoInfo .photoControls
{
        min-height: 25px;
        overflow: hidden;
        margin-bottom: 5px;
}

#albumPhoto .photoInfo .photoDescriptionContainer .AlbumPhotoDescriptionEditor
{
        cursor: pointer;
}

#albumPhoto .photoInfo .photoDescriptionContainer .photoDescription em
{
        font-style: italic;
}

#albumPhoto .photoInfo .photoControl
{
        display: inline-block;
        background-repeat: none;
        background-position: center center;
        min-height: 16px;
        min-width: 16px;
}

#albumPhoto .photoInfo .photoControl.photoDescriptionEdit
{
        background-image: url({xen:property imagePath}/album/icons/pencil.png);
        min-height: 12px;
        min-width: 12px;
}

#albumPhoto .photoInfo .photoControl.photoSetCover
{
        background-image: url({xen:property imagePath}/album/icons/photos.png);
}

#albumPhoto .photoInfo .photoControl.photoDelete
{
        background-image: url({xen:property imagePath}/album/icons/delete.png);
}

#albumPhoto .photoInfo .photoDescriptionContainer .photoDescriptionForm input[type=text]
{
        width: 80%;
}

#albumPhoto .photoInfo .leftBar
{
        width: 59%;
        float: left;
}

#albumPhoto .photoInfo .rightBar
{
       width: 39%;
       float: right;
       text-align: left;
}


#albumPhoto .photoInfo .leftBar .userInfo .avatar
{
        float: left;
        margin-right: 5px;
}

#albumPhoto .photoInfo .leftBar .userInfo .avatar img
{
        width: 26px;
        height: 26px;
}

#albumPhoto .photoInfo .leftBar .userInfo .username
{
        display: block;
        font-weight: bold;
}

#albumPhoto .photoInfo .rightBar .albumInfo
{
        min-height: 36px;
        border-bottom: 1px solid rgb(238, 238, 238);
        margin-bottom: 10px;
}

#albumPhoto .hideUnlessOverlay
{
        display: none;
}

.xenOverlay #albumPhoto
{
        margin-bottom: 50px;
}

.xenOverlay #albumPhoto .hideUnlessOverlay
{
        display: inline;
}

.xenOverlay #albumPhoto .hideOnOverlay
{
        display: none;
}

.xenOverlay #albumPhoto h2.heading
{
        display: none;
}

.xenOverlay #albumPhoto.primaryContent
{
        border: 1px rgba(0, 0, 0, .2) solid;
        box-shadow: 0 1px 2px rgba(0, 0, 0, .1);
        overflow: visible;
}

.xenOverlay #albumPhoto .data .navigation
{
        float: none;
}

.xenOverlay a.navButton
{
        background-color: rgb(255, 255, 255);
        font-size: 11px;
        border: 1px solid rgb(153, 153, 153);
        border-radius: 2px;
        padding: 4px 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, .1);
        cursor: pointer;
}

.xenOverlay a.navButton:hover
{
        border-color: rgb(116, 137, 182);
        text-decoration: none;
}

.xenOverlay a.navButton:active
{
       background-color: rgb(239, 239, 239) !important;
}

.xenOverlay #albumPhoto .data .navigation a
{
        background: rgb(255, 255, 255) no-repeat center center;
        height: 30px;
        width: 22px;
        text-indent: -9999px;
        white-space: nowrap;
        overflow: hidden;
        margin-top: 200px;
}

.xenOverlay #albumPhoto .data .navigation .prev
{
        background-image: url({xen:property imagePath}/album/nav/prev.png);
        float: left;
        margin-left: -70px;
}

.xenOverlay #albumPhoto .data .navigation .next
{
        background-image: url({xen:property imagePath}/album/nav/next.png);
        float: right;
        margin-right: -70px;
}

.xenOverlay a.navButton.close
{
        position: fixed;
        top: -2px;
        right: 88px;
        width: auto;
        height: auto;
        background-image: none;
        padding: 6px 8px;
}

.xenOverlay #albumPhoto .photoInfo .rightBar .albumInfo
{
        display: block;
}]]></template>
    <template title="album_account_management_list_item" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<xen:if is="{$visitor.user_id}">
        <li><a class="primaryContent" href="{xen:link albums, $visitor}">{xen:phrase album_your_albums}</a></li>
</xen:if>]]></template>
    <template title="album_add" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album_manage.css" />
<xen:require js="js/album/album.js" />

<xen:title>{xen:phrase album_add_album}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/create}" method="post" class="xenForm formOverlay AutoValidator" id="albumAddPhotos" data-redirect="on">

<dl class="ctrlUnit">
	<dt>
                <label for="ctrl_album_name">{xen:phrase album_album_name}:</label>
        </dt>
	<dd><input type="text" name="name" value="{$album.name}" id="ctrl_album_name" class="textCtrl" data-liveTitleTemplate="{xen:phrase album_add_album}: <em>%s</em>" /></dd>
</dl>

<xen:if is="{$attachmentParams}">
	<dl class="ctrlUnit AttachedFilesUnit">
		<dt><label for="ctrl_uploader">{xen:phrase album_photos}:</label></dt>
		<dd>
                        <xen:include template="attachment_editor" />
                </dd>
	</dl>
</xen:if>

<dl class="ctrlUnit submitUnit">
	<dt></dt>
	<dd>
		<input type="submit" class="button primary" value="{xen:phrase album_save_album}" />
                <xen:include template="attachment_upload_button">
                        <xen:set var="$buttonText">{xen:phrase album_add_photos}</xen:set>
                </xen:include>
                <input type="reset" class="button OverlayCloser ResetButton" value="{xen:phrase cancel}" />
	</dd>
</dl>

<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>

<script type="text/javascript">
	$(document).ready(function() {
		new XenForo.AddPhotosButton();
	});
</script>]]></template>
    <template title="album_delete" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:title>{xen:phrase album_delete_album_x, 'album={$album.name}'}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/delete, $album}" method="post" class="xenForm formOverlay" id="albumDelete" data-redirect="on">

        <p>{xen:phrase album_all_album_contents_will_be_removed}</p>

	<dl class="ctrlUnit submitUnit">
		<dt></dt>
		<dd>
			<input type="submit" value="{xen:phrase album_delete_album}" class="button primary" />
		</dd>
	</dl>

	<input type="hidden" name="_xfConfirm" value="1" />
	<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="album_manage" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album_manage.css" />

<xen:title>{xen:phrase album_manage_album}: {$album.name}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/save, $album}" method="post" class="xenForm formOverlay AutoValidator" id="albumAddPhotos" data-redirect="on">

<dl class="ctrlUnit">
	<dt>
                <label for="ctrl_album_name">{xen:phrase album_album_name}:</label>
        </dt>
	<dd><input type="text" name="name" value="{$album.name}" id="ctrl_album_name" class="textCtrl" data-liveTitleTemplate="{xen:phrase album_manage_album}: <em>%s</em>" /></dd>
</dl>

<xen:if is="{$attachmentParams}">
	<dl class="ctrlUnit AttachedFilesUnit">
		<dt><label for="ctrl_uploader">{xen:phrase album_new_photos}:</label></dt>
		<dd>
                        <xen:include template="attachment_editor" />
                </dd>
	</dl>
</xen:if>

<dl class="ctrlUnit submitUnit">
	<dt></dt>
	<dd>
		<input type="submit" class="button primary" value="{xen:phrase album_save_album}" />
                <xen:include template="attachment_upload_button">
                        <xen:set var="$buttonText">{xen:phrase album_add_photos}</xen:set>
                </xen:include>
                <input type="button" value="{xen:phrase album_delete_album}" class="button OverlayTrigger DisableOnSubmit" data-href="{xen:link albums/delete, $album}">
	</dd>
</dl>

<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="album_manage.css" version_id="2" version_string="0.1.0 Alpha"><![CDATA[div.AttachmentInsertAll
{
        display: none !important;
}

div.label,
.AttachmentInserter
{
        display: none !important;
}

.Filename a
{
        color: rgb(84, 29, 29) !important;
}]]></template>
    <template title="album_member_card_link_item" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<a href="{xen:link albums, $user}">{xen:phrase album_albums}</a>]]></template>
    <template title="album_navigation_list_item_member" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<xen:if is="{$visitor.user_id}">
        <li><a href="{xen:link albums, $visitor}">{xen:phrase album_your_albums}</a></li>
</xen:if>]]></template>
    <template title="album_photo" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album.css" />
<xen:require js="js/album/album.js" />

<xen:title>
{xen:phrase album_xs_albums_y,
        'username={$user.username}',
        'album={$album.name}'}
</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
</xen:navigation>

<xen:if is="{$album.permissions.manage}">
	<xen:topctrl>
		<a href="{xen:link albums/manage, $album}" class="callToAction"><span>{xen:phrase album_manage_album}</span></a>
	</xen:topctrl>
</xen:if>

<div id="albumPhoto" class="albumPhoto primaryContent" data-author="{$user.username}">
        <div class="data">
                <div class="stats hideOnOverlay">
                        <p>{xen:phrase album_photo_x_of_y,
                                   'current={$photo.position}',
                                   'total={$album.photo_count}'}</p>
                </div>
                <xen:if is="{$album.photo_count} > 1">
                        <div class="navigation">
                                <a class="navButton prev AlbumPhotoLoader" href="{xen:link albums/view-photo, $photo.prev}">{xen:phrase album_previous}</a>
                                <a class="navButton next AlbumPhotoLoader" href="{xen:link albums/view-photo, $photo.next}">{xen:phrase album_next}</a>
                        </div>
                </xen:if>
        </div>
        <xen:if is="{$album.photo_count} > 1">
                <a class="AlbumPhotoLoader" href="{xen:link albums/view-photo, $photo.next}" data-photo-id="{$photo.photo_id}">
                        <div id="photo-{$photo.attachment_id}" class="photo">
                                <img id="photo" src="{xen:link attachments, $photo}" alt="{xen:if {$photo.description}, {$photo.description}, {$photo.filename}}" width="{$photo.width}" height="{$photo.height}" {xen:if $photo.margin-top, 'style="margin-top: {$photo.margin-top}px;"'} />
                        </div>
                </a>  
        <xen:else />
                <div id="photo-{$photo.attachment_id}" class="photo">
                        <img src="{xen:link attachments, $photo}" alt="{xen:if {$photo.description}, {$photo.description}, {$photo.filename}}" width="{$photo.width}" height="{$photo.height}"   {xen:if $photo.margin-top, 'style="margin-top: {$photo.margin-top}px;"'} />
                </div>
        </xen:if>

        <div class="photoInfo">
                <div class="photoControls">
                         <div class="leftBar">
                                <xen:include template="album_photo_description" />
                         </div>
                         <xen:if is="{$album.permissions.manage}">
                         <div class="rightBar">
                                <xen:if is="!{$photo.is_cover}"><a class="photoControl photoSetCover OverlayTrigger" href="{xen:link albums/set-cover, $photo}"></a></xen:if>
                                <a class="photoControl photoDelete OverlayTrigger" href="{xen:link albums/delete-photo, $photo}"></a>
                         </div>
                         </xen:if>
                </div>

                <div class="photoLinks">
                        <div class="leftBar">
                                <div class="userInfo hideUnlessOverlay">
                                        <xen:avatar user="$user" size="s" img="true" />
                                        <xen:username user="$user" />
                                </div>
                        <div class="photoDate">{xen:phrase album_added} <xen:datetime time="$photo.attach_date" /></div>
                        </div>
                        <div class="rightBar">
                                <div class="albumInfo hideUnlessOverlay">
                                        {xen:phrase album_from_the_album,
                                                'link_params= href="{xen:link albums/view, $album}"',
                                                'album={$album.name}'}
                                </div>
                                <a href="{xen:link attachments, $photo}" target="_blank">{xen:phrase album_view_full_size}</a>
                        </div>
                </div>
        </div>
	<script type="text/javascript">
                <!--
                var url = '{xen:jsescape {xen:link albums/view-photo, $photo}}';
                if (window.location.pathname + window.location.search != '/' + url)
                {
                        window.history.pushState('', '', url);
                }

                if ($('.a.close.OverlayCloser'))
		{            
			function closeText()
			{
				$('a.close.OverlayCloser').addClass('navButton').html('{xen:jsescape {xen:phrase album_close}}');
			}

			setTimeout(closeText, 100);
		}
                -->
	</script>
</div>]]></template>
    <template title="album_photo_delete" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:title>{xen:phrase album_delete_photo_in_album_x, 'album={$album.name}'}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums/view-photo, $photo}">{xen:phrase album_photos}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/delete-photo, $photo}" method="post" class="xenForm formOverlay" id="albumPhotoDelete" data-redirect="on">

        <p>{xen:phrase album_all_photo_contents_will_be_removed}</p>

	<dl class="ctrlUnit submitUnit">
		<dt></dt>
		<dd>
			<input type="submit" value="{xen:phrase album_delete_photo}" class="button primary" />
		</dd>
	</dl>

	<input type="hidden" name="_xfConfirm" value="1" />
	<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="album_photo_description" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:if is="{$photo.description} OR {$album.permissions.manage}">
<div class="photoDescriptionContainer">
         <p class="photoDescription {xen:if '{$album.permissions.manage} && !{$photo.description}', 'AlbumPhotoDescriptionEditor'}">
                 {xen:if {$photo.description}, {$photo.description}, '<em>{xen:phrase album_add_description}</em>'}
                 <xen:if is="{$album.permissions.manage}"><a class="photoControl photoDescriptionEdit {xen:if {$photo.description}, 'AlbumPhotoDescriptionEditor'}" href="{xen:link albums/manage-photo, $photo}"></a></xen:if>
         </p>
         <xen:if is="{$album.permissions.manage}">
                <form action="{xen:link albums/manage-photo, $photo}" id="description-{$photo.photo_id}" method="post" class="photoDescriptionForm" style="display: none;">
                        <input type="text" name="description" id="ctrl_photo_description" class="textCtrl" {xen:if $photo.description, 'value="{$photo.description_raw}"'} />
                        <input type="submit" class="button primary" value="{xen:phrase save}">
                </form>
        </xen:if>
</div>
</xen:if>]]></template>
    <template title="album_photo_manage" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album_manage.css" />

<xen:title>
        {xen:phrase album_edit_photo}
</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums/view-photo, $photo}">{xen:phrase album_photos}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/manage-photo, $photo}" method="post" class="xenForm formOverlay" id="albumEditPhoto" data-redirect="on">

<dl class="ctrlUnit">
	<dt>
                <label for="ctrl_photo_description">{xen:phrase album_photo_description}:</label>
        </dt>
	<dd><input type="text" name="description" value="{$photo.description}" id="ctrl_photo_description" class="textCtrl" /></dd>
</dl>

<dl class="ctrlUnit submitUnit">
	<dt></dt>
	<dd>
		<input type="submit" class="button primary" value="{xen:phrase album_save_photo}" />
                <input type="button" value="{xen:phrase album_delete_photo}" class="button OverlayTrigger DisableOnSubmit" data-href="{xen:link albums/delete-photo, $photo}">
	</dd>
</dl>

<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="album_profile_tab" version_id="0" version_string="0.0.1 Pre-alpha"><![CDATA[<li><a href="{$requestPaths.requestUri}#albums">{xen:phrase album_albums}</a></li>

<xen:edithint template="album_profile_tab_content" />
<xen:edithint template="album_user" />
]]></template>
    <template title="album_profile_tab_content" version_id="0" version_string="0.0.1 Pre-alpha"><![CDATA[<li id="album" class="profileContent" data-loadUrl="{xen:link albums, $user}">
        {xen:phrase loading}...
        <noscript><a href="{xen:link albums, $user}">{xen:phrase view}</a></noscript>
</li>

<xen:edithint template="album_user" />]]></template>
    <template title="album_recent_activity_block_items" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<xen:if is="{$item.content_type} == 'album' AND {$item.action} == 'name'">
	{xen:phrase album_x_renamed_an_album_from_y_to_z,
                'username={xen:helper username, $item.user, 'primaryText'}',
                'old={$item.name.old}',
                'link_params=href="{xen:link albums/view, $item.content}"',
                'new={$item.content.name}'
        }
</xen:if>

<xen:if is="{$item.content_type} == 'album' AND {$item.action} == 'photos'">
        <xen:if is="{$item.photos.new} == 1">
                {xen:phrase album_x_has_added_a_new_photo_to_album_z,
                        'username={xen:helper username, $item.user, 'primaryText'}',
                        'link_params=href="{xen:link albums/view, $item.content}"',
                        'name={$item.content.name}'
        }
        <xen:else />
                {xen:phrase album_x_has_added_y_new_photos_to_album_z,
                        'username={xen:helper username, $item.user, 'primaryText'}',
                        'new={$item.photos.new}',
                        'link_params=href="{xen:link albums/view, $item.content}"',
                        'name={$item.content.name}'
                }
        </xen:if>
</xen:if>

<xen:if is="{$item.content_type} == 'album' AND {$item.action} == 'add'">
        {xen:phrase album_x_has_added_a_new_album_y,
                'username={xen:helper username, $item.user, 'primaryText'}',
                'link_params=href="{xen:link albums/view, $item.content}"',
                'name={$item.content.name}'
        }
</xen:if>]]></template>
    <template title="album_set_cover" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:title>{xen:phrase album_set_cover_photo_for_x, 'album={$album.name}'}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
	<xen:breadcrumb href="{xen:link full:albums/view, $album}">{$album.name}</xen:breadcrumb>
</xen:navigation>

<form action="{xen:link albums/set-cover, $photo}" method="post" class="xenForm formOverlay" id="albumSetCover">

	<dl class="ctrlUnit submitUnit">
		<dt></dt>
		<dd>
			<input type="submit" value="{xen:phrase album_make_cover_photo}" class="button primary" />
		</dd>
	</dl>

	<input type="hidden" name="_xfConfirm" value="1" />
	<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="album_user" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album.css" />

<xen:title>{xen:phrase album_albums}</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
</xen:navigation>

<xen:if is="{$visitor.user_id} == {$user.user_id} AND {$permissions.upload}">
	<xen:topctrl>
		<a href="{xen:link albums/add}" class="callToAction"><span>{xen:phrase album_add_album}</span></a>
	</xen:topctrl>
</xen:if>

<div id="albumUser">
	<div id="albums" class="primaryContent">
	        <xen:if is="{$albums}">
	        	<xen:foreach loop="$albums" value="$album">
		                <div id="album-{$album.album_id}" class="imageBox">
		                        <a href="{xen:link albums/view, $album}">
		                                <div class="thumbnail" style="background-image: url({$album.cover.thumbnailUrl})"></div>
		                        </a>
		                        <div class="stats">                        
		                                <span class="name"><a href="{xen:link albums/view, $album}">{$album.name}</a></span>
		                                <span class="count muted">
		                                        <xen:if is="{$album.photo_count} > 1">
		                                                {xen:phrase album_x_photos, 'photos={xen:number $album.photo_count}'}
		                                        <xen:else />
		                                                {xen:phrase album_one_photo}
		                                        </xen:if>
		                                </span>
		                        </div>
		                </div>
		        </xen:foreach>
		<xen:else />
			<p>{xen:phrase album_user_no_albums}</p>
		</xen:if>
	</div>
	<xen:if is="{$visitor.user_id} == {$user.user_id} AND {$permissions.upload}">
	        <div class="sectionFooter">
	                <a href="{xen:link albums/add}">{xen:phrase album_add_album}</a>
	        </div>
	</xen:if>
</div>]]></template>
    <template title="album_view" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<xen:require css="album.css" />

<xen:title>
{xen:phrase album_xs_albums_y,
        'username={$user.username}',
        'album={$album.name}'}
</xen:title>

<xen:navigation>
        <xen:breadcrumb href="{xen:link full:members, $user}">{$user.username}</xen:breadcrumb>
        <xen:breadcrumb href="{xen:link full:albums, $user}">{xen:phrase album_albums}</xen:breadcrumb>
</xen:navigation>

<xen:if is="{$album.permissions.manage}">
	<xen:topctrl>
		<a href="{xen:link albums/manage, $album}" class="callToAction"><span>{xen:phrase album_manage_album}</span></a>
	</xen:topctrl>
</xen:if>

<div id="album" class="primaryContent" data-author="{$user.username}">
        <xen:if is="{$album.photos}">
        	<xen:foreach loop="$album.photos" value="$photo">
	                <div id="photo-{$photo.attachment_id}" class="imageBox">
	                        <a class="OverlayTrigger" href="{xen:link albums/view-photo, $photo}" data-cacheoverlay="false" data-overlayoptions="{&quot;fixed&quot;:false}">
	                                <div class="thumbnail">
	                                        <img src="{$photo.thumbnailUrl}" alt="{$photo.filename}" style="margin-top: {$photo.offset}px;" />
	                                </div>
	                        </a>
	                </div>
	        </xen:foreach>
        <xen:else />
                <p>{xen:phrase album_no_photos_in_album}</p>
        </xen:if>
</div>]]></template>
    <template title="news_feed_item_album_add" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<h3 class="description">
{xen:phrase album_x_has_added_a_new_album_y,
        'username={xen:helper username, $user, 'primaryText'}',
        'link_params=href="{xen:link albums/view, $content}"',
        'name={$content.name}'
}
</h3>

<p class="snippet">
{xen:phrase album_x_photos_in_album,
        'photos={$content.photo_count}'
}
</p>]]></template>
    <template title="news_feed_item_album_name" version_id="1" version_string="0.0.1 Alpha"><![CDATA[<h3 class="description">
{xen:phrase album_x_renamed_an_album_from_y_to_z,
        'username={xen:helper username, $user, 'primaryText'}',
        'old={$name.old}',
        'link_params=href="{xen:link albums/view, $content}"',
        'new={$content.name}'
}
</h3>]]></template>
    <template title="news_feed_item_album_photos" version_id="2" version_string="0.1.0 Alpha"><![CDATA[<h3 class="description">
{xen:phrase album_x_has_added_new_photos_to_album_z,
        'username={xen:helper username, $user, 'primaryText'}',
        'link_params=href="{xen:link albums/view, $content}"',
        'name={$content.name}'
}
</h3>

<p class="snippet">
{xen:phrase album_x_photos_in_album,
        'photos={$content.photo_count}'
}
</p>

<xen:if is="{$content.attachments}">
<xen:if hascontent="true"> 
<xen:require css="events.css" />
	<xen:contentcheck>
	<xen:foreach loop="$content.attachments" value="$attachment">
        <a href="{xen:link albums/view-photo, $attachment}" class="attachedImages OverlayTrigger">
		<xen:if is="{$attachment.thumbnailUrl}">
			<img src="{$attachment.thumbnailUrl}" alt="{$attachment.filename}" />
		</xen:if>
        </a>
	</xen:foreach>
        </xen:contentcheck>
</xen:if>
</xen:if>]]></template>
  </templates>
</addon>
